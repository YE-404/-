

<!DOCTYPE html>
<html xmlns:v-bind="http://www.w3.org/1999/xhtml">

<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">

    <title></title>
    <link rel="shortcut icon" href="img/favicon.ico">
    
    <!-- global stylesheets -->
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed" rel="stylesheet">
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/font-awesome.min.css">
<!--  /font-awesome-4.7.0/css/  -->
    <link rel="stylesheet" href="../css/font-icon-style.css">
    <link rel="stylesheet" href="../css/style.default.css" id="theme-stylesheet">
    <link rel="stylesheet" href="../css/form.css" />
    <!-- Core stylesheets -->
    <link rel="stylesheet" href="../css/profile.css">

</head>

<body >
<div id="menuApp">
<!--====================================================
                         MAIN NAVBAR
======================================================-->        
    <header class="header">
        <nav class="navbar navbar-expand-lg ">
            <div class="search-box">
                <button class="dismiss"><i class="icon-close"></i></button>
                <form id="searchForm" action="#" role="search">
                    <input type="search" placeholder="Search Now" class="form-control">
                </form>
            </div>
            <div class="container-fluid ">
                <div class="navbar-holder d-flex align-items-center justify-content-between">
                    <div class="navbar-header">
                        <a href="hostservlet" class="navbar-brand">
                            <div class="brand-text brand-big hidden-lg-down"><img src="../img/logo-white.png" alt="Logo" class="img-fluid"></div>
                            <div class="brand-text brand-small"><img src="../img/logo-icon.png" alt="Logo" class="img-fluid"></div>
                        </a>
                        <a id="toggle-btn" href="#" class="menu-btn active">
                            <span></span>
                            <span></span>
                            <span></span>
                        </a>
                    </div>
                </div>
                <ul class="nav-menu list-unstyled d-flex flex-md-row align-items-md-center">
                    <li class="nav-item dropdown"><a id="profile" class="nav-link logout" data-target="#" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><img v-bind:src= "user.avatarUrl" alt="..." class="img-fluid rounded-circle" style="height: 30px; width: 30px;"></a>
                        <ul aria-labelledby="profile" class="dropdown-menu profile">

                            <li>
                                <a rel="nofollow" href="#" class="dropdown-item d-flex">
                                    <div class="msg-profile"> <img v-bind:src= "user.avatarUrl" alt="..." class="img-fluid rounded-circle"></div>
                                    <div class="msg-body">
                                        <h3 class="h5">{{user.username}}</h3>
                                    </div>
                                </a>
                                <hr>
                            </li>

                            <li>
                                <a rel="nofollow" href="profile" class="dropdown-item">
                                    <div class="notification">
                                        <div class="notification-content"><i class="fa fa-user "></i>用户基本信息</div>
                                    </div>
                                </a>
                            </li>

                            <li>
                                <a rel="nofollow" href="logout" class="dropdown-item">
                                    <div class="notification">
                                        <div class="notification-content"><i class="fa fa-power-off"></i>注销</div>
                                    </div>
                                </a> 
                            </li>
                        </ul>
                    </li>
                </ul> 
            </div>
        </nav>
    </header>

<!--====================================================
                        PAGE CONTENT
======================================================-->
    <div class="page-content d-flex align-items-stretch">

        <!--***** SIDE NAVBAR *****-->
        <nav class="side-navbar">
            <div class="sidebar-header d-flex align-items-center" >
                <div class="avatar">
                    <img v-bind:src= "user.avatarUrl" alt="..." class="img-fluid rounded-circle"/>
                    <!--     "../img/avatar-1.jpg"           -->
                </div>
                <div class="title">
                    <h1 class="h4">{{user.username}}</h1>
                </div>
            </div>
            <hr/>
            <!-- Sidebar Navidation Menus-->
            <!-- !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!-->
            <ul class="list-unstyled">
                <li><a href="hostservlet"><i class="icon-home"></i>主页</a></li>
                <li><a href="#forms" aria-expanded="false" data-toggle="collapse"> <i class="fa fa-building-o"></i>检测功能 </a>
                    <ul id="forms" class="collapse list-unstyled">
                        <li><a href="lightcheck">开关/彩灯识别</a></li>
                        <li><a href="clockcheck">数显/指针表识别</a></li>
                    </ul>
                </li>
                <li><a href="spellservlet"> <i class="fa fa-map-o"></i>图像拼接 </a></li>
                <li><a href="#apps" aria-expanded="false" data-toggle="collapse"> <i class="icon-interface-windows"></i>数据库查询
                </a>
                    <ul id="apps" class="collapse list-unstyled">
                        <li><a href="lighttable">彩灯数据库</a></li>
                        <li><a href="switchtable">开关数据库</a></li>
                        <li><a href="numbertable">数显表数据库</a></li>
                        <li><a href="pointtable">指针表数据库</a></li>
                    </ul>
                </li>
                <li><a href="#pages" aria-expanded="false" data-toggle="collapse"> <i class="fa fa-file-o"></i>模型管理 </a>
                    <ul id="pages" class="collapse list-unstyled">
                        <li><a href="weightSelf">我的模型</a></li>
                        <li><a href="weightServlet">模型仓库</a></li>
                    </ul>
                </li>
            </ul>

            <span class="heading" id="managerInfo1">管理员功能</span>
            <ul class="list-unstyled" id="managerInfo2" >
                <li><a href="manageservlet"> <i class="fa fa-globe"></i>系统管理</a></li>
                <li><a href="logmanage"> <i class="fa fa-file-o"></i>日志管理</a></li>
            </ul>
        </nav>

        <div class="content-inner chart-cont">

            <!--***** CONTENT *****-->     
            <div class="row mt-2" id="card-prof">
                <div class="col-md-3" >
                    <div class="card hovercard">
<!--                        -->
                        <div class="cardheader"></div>
                        <div class="avatar">
                            <img alt="" v-bind:src= "user.avatarUrl" class="img-fluid">
                        </div>
                        <div class="info">
                            <div class="title">
                                <h1 class="h5">{{user.username}}</h1>
                            </div>
                            <hr>
                        </div>
                        <nav class="nav text-center prof-nav">
                            <ul  class="list-unstyled ">
                                <li><a href="logout">注销</a></li>
                            </ul>
                        </nav>
                    </div>
                </div>
                <div class="col-md-9">
                    <div class="card hovercard">
                        <div class="tab" role="tabpanel"> 
                            <ul class="nav nav-tabs" role="tablist">
                              <li class="nav-item ">
                                <a class="nav-link active" href="#profileMenu" role="tab" data-toggle="tab"><span><i class="fa fa-user"></i></span> 用户信息</a>
                              </li>
                              <li class="nav-item">
                                <a class="nav-link" href="#references" role="tab" data-toggle="tab"><span><i class="fa fa-cog"></i></span> 修改密码</a>
                              </li>
                            </ul>

                            <!-- Tab panes -->
                            <div class="tab-content tabs">
                              <div role="tabpanel" class="tab-pane fade show active" id="profileMenu">
                                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras nec urna aliquam, ornare eros vel, malesuada lorem. Nullam faucibus lorem at eros consectetur lobortis. Maecenas nec nibh congue, placerat sem id, rutrum velit. </p>
                                    <div class="row mt-3">
                                        <h5 class="col-12 mb-2">User Info</h5>
                                        <div class="col-6">
                                            <div class="form-group">
                                                <strong class="mr-5"><i class="fa fa-globe"> 用户名: &nbsp;&nbsp;&nbsp;&nbsp;</i></strong>    {{user.username}}
                                            </div>
                                            <div class="form-group">
                                                <strong class="mr-5"><i class="fa fa-map"> 注册时间:</i></strong>   {{user.registerTime}}
                                            </div>
                                            <div class="form-group">
                                                <strong class="mr-5"><i class="fa fa-map-marker"> 登录次数: &nbsp</i></strong>  {{user.loginTimes}} 次
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <div class="form-group">
                                                <strong class="mr-5"><i class="fa fa-envelope"> 用户日志大小: </i></strong>  {{log.fileSize}}

                                            </div>

                                            <div class="form-group">
                                                <strong class="mr-5"><i class="fa fa-map"> 日志修改时间: </i></strong>    {{log.changeDate}}
                                            </div>

                                            <div class="form-group">
                                                <strong class="mr-5"><i class="fa fa-globe"> 日志保存位置: </i></strong>    {{log.savePath}}
                                                <a href="download" rel="external nofollow" download>&nbsp; 下载 </a>
                                                <a v-bind:href="lookup" rel="external nofollow" >&nbsp; 查看 </a>
                                            </div>
                                        </div>
                                    </div>
                              </div>
                              <div id="references" role="tabpanel" class="tab-pane fade">
<!--                                 -->
                                    <div class="row mx-2">
                                        <div class="col-md-12 panel-heading">
                                            <h3 class="panel-title"><i class="fa fa-comment"></i> Edit Info</h3><br>
                                        </div>
                                        <div class="col-md-6 ">
                                            <div class="form-group row">
                                                <label for="example-text-input" style="width: 85px;" class=" col-form-label" >用户名</label>
                                                <div class="col-9">
                                                    <input class="form-control" type="text" value="请输入当前登录的用户名" id="example-text-input" v-model="change.username">
                                                </div>
                                            </div> 
                                            <div class="form-group row">
                                                <label for="example-email-input" style="width: 85px;" class=" col-form-label">原密码</label>
                                                <div class="col-9">
                                                    <input class="form-control" type="password"  id="example-email-input" v-model="change.oriPassword">
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label for="example-url-input" style="width: 85px;" class=" col-form-label">新密码</label>
                                                <div class="col-9">
                                                    <input class="form-control" type="password"  id="example-url-input" v-model="change.newPassword">
                                                </div>
                                            </div>
<!--                                            <input type="submit" class="btn btn-general btn-blue mr-2"  ></input>-->
                                            <el-row>
                                                <el-button type="primary" plain @click="submit">确认修改</el-button>
                                            </el-row>
<!--                                            <button type="button" class="btn btn-primary">Primary</button>-->

                                        </div>

                                    </div> 
                              </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div> 

        </div>
    </div> 
</div>
    <!--Global Javascript -->
    <script src="../js/jquery.min.js"></script>
    <script src="../js/popper/popper.min.js"></script>
    <script src="../js/tether.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/jquery.cookie.js"></script>
    <script src="../js/jquery.validate.min.js"></script>
    <script src="../js/chart.min.js"></script>
    <script src="../js/front.js"></script>
    <script src="../js/axios-0.18.0.js" ></script>
    <script src="../js/vue.js"></script>
    <script src="../element-ui/lib/index.js"></script>
    <script src="../js/echarts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/v-charts/lib/index.min.js"></script>
    <link rel="stylesheet" href="../element-ui/lib/theme-chalk/index.css">

<script>
    var local = window.location.host;
    var ip = window.location.hostname;
    new Vue({
        el:"#menuApp",
        data(){
            return{
                download:"http://" + local + "/menu/download",
                lookup:"http://" + ip + "/log/user",
                log:[],
                user:[],
                change:{},
                message:"",
                hint:""

            }
        },
        mounted(){
            axios({
                method:"get",
                url:"http://" + local + "/menu/hostdataservlet"
            }).then(resp =>{
                console.log(resp.data);
                this.user = resp.data;
                if(this.user.id === 15){
                    $("#managerInfo1").show();
                    $("#managerInfo2").show();
                }else{
                    $("#managerInfo1").hide();
                    $("#managerInfo2").hide();
                }
            })
            axios({
                method:"get",
                url:"http://" + local + "/menu/profilelog"
            }).then(resp =>{
                console.log(resp.data);
                this.log = resp.data;
                this.log["savePath"] = this.log["savePath"].replace("127.0.0.1",ip);
                this.lookup = this.log["savePath"]
            })
        },
        methods: {
            submit(){
                axios({
                    method: "post",
                    url: "http://" + local + "/menu/profilechange",
                    data:this.change
                }).then(resp => {
                    this.message = resp.data;
                    if(this.message == "usernameWrong"){
                        this.hint = "用户名错误";
                    }else if(this.message == "oriPasswordWrong"){
                        this.hint = "原密码错误";
                    }else if(this.message == "newSameOri"){
                        this.hint = "新密码与原密码不得一致";
                    }else if(this.message == "newPasswordEmpty"){
                        this.hint = "新密码不得为空";
                    }else if(this.message == "ok"){
                        this.hint = "修改成功";
                    }else if(this.message == "wrong"){
                        this.hint = "未知错误";
                    }
                    this.$alert(this.hint,'提示' ,{
                        confirmButtonText: '确定',
                        callback: action => {
                            this.$message({
                                type: 'info',
                                message: `action: ${ action }`
                            });
                        }
                    });
                })
            }
        }
    })
</script>
</body>

</html>