<!DOCTYPE html>
<html xmlns:v-bind="http://www.w3.org/1999/xhtml">
 <head> 
  <meta charset="utf-8" /> 
  <meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
  <meta name="description" content="" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1" /> 
  <meta name="robots" content="all,follow" /> 
  <title></title> 
  <link rel="shortcut icon" href="img/favicon.ico" /> 
  <!-- global stylesheets --> 
  <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed" rel="stylesheet" /> 
  <link rel="stylesheet" href="../css/bootstrap.min.css" />
  <link rel="stylesheet" href="../css/font-awesome.min.css" />
  <link rel="stylesheet" href="../css/font-icon-style.css" />
  <link rel="stylesheet" href="../css/style.default.css" id="theme-stylesheet" />
  <!-- Core stylesheets --> 
  <link rel="stylesheet" href="../css/form.css" />
 </head> 
 <body>
 <div id="menuApp">
  <!--====================================================
                     MAIN NAVBAR
======================================================-->
  <header class="header">
   <nav class="navbar navbar-expand-lg ">
    <div class="search-box">
     <button class="dismiss"><i class="icon-close"></i></button>
     <form id="searchForm" action="#" role="search">
      <input type="search" placeholder="Search Now" class="form-control">
     </form>
    </div>
    <div class="container-fluid ">
     <div class="navbar-holder d-flex align-items-center justify-content-between">
      <div class="navbar-header">
       <a href="hostservlet" class="navbar-brand">
        <div class="brand-text brand-big hidden-lg-down"><img src="../img/logo-white.png" alt="Logo" class="img-fluid"></div>
        <div class="brand-text brand-small"><img src="../img/logo-icon.png" alt="Logo" class="img-fluid"></div>
       </a>
       <a id="toggle-btn" href="#" class="menu-btn active">
        <span></span>
        <span></span>
        <span></span>
       </a>
      </div>
     </div>
     <ul class="nav-menu list-unstyled d-flex flex-md-row align-items-md-center">
      <li class="nav-item dropdown"><a id="profile" class="nav-link logout" data-target="#" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><img v-bind:src= "user.avatarUrl" alt="..." class="img-fluid rounded-circle" style="height: 30px; width: 30px;"></a>
       <ul aria-labelledby="profile" class="dropdown-menu profile">

        <li>
         <a rel="nofollow" href="#" class="dropdown-item d-flex">
          <div class="msg-profile"> <img v-bind:src= "user.avatarUrl" alt="..." class="img-fluid rounded-circle"></div>
          <div class="msg-body">
           <h3 class="h5">{{user.username}}</h3>
          </div>
         </a>
         <hr>
        </li>

        <li>
         <a rel="nofollow" href="profile" class="dropdown-item">
          <div class="notification">
           <div class="notification-content"><i class="fa fa-user "></i>用户基本信息</div>
          </div>
         </a>
        </li>

        <li>
         <a rel="nofollow" href="logout" class="dropdown-item">
          <div class="notification">
           <div class="notification-content"><i class="fa fa-power-off"></i>注销</div>
          </div>
         </a>
        </li>
       </ul>
      </li>
     </ul>
    </div>
   </nav>
  </header>
  <!--====================================================
                    PAGE CONTENT
======================================================--> 
  <div class="page-content d-flex align-items-stretch"> 
   <!--***** SIDE NAVBAR *****-->
   <nav class="side-navbar">
    <div class="sidebar-header d-flex align-items-center" >
     <div class="avatar">
      <img v-bind:src= "user.avatarUrl" alt="..." class="img-fluid rounded-circle"/>
      <!--     "../img/avatar-1.jpg"           -->
     </div>
     <div class="title">
      <h1 class="h4">{{user.username}}</h1>
     </div>
    </div>
    <hr/>
    <!-- Sidebar Navidation Menus-->
    <!-- !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!-->
    <ul class="list-unstyled">
     <li ><a href="hostservlet"><i class="icon-home"></i>主页</a></li>
<!-- class="active"    -->
     <li><a href="#forms" aria-expanded="false" data-toggle="collapse"> <i class="fa fa-building-o"></i>检测功能 </a>
      <ul id="forms" class="collapse list-unstyled">
       <li><a href="lightcheck">开关/彩灯识别</a></li>
       <li><a href="clockcheck">数显/指针表识别</a></li>
      </ul>
     </li>
     <li class="active"><a href="spellservlet"> <i class="fa fa-map-o"></i>图像拼接 </a></li>
     <li><a href="#apps" aria-expanded="false" data-toggle="collapse"> <i class="icon-interface-windows"></i>数据库查询
     </a>
      <ul id="apps" class="collapse list-unstyled">
       <li><a href="lighttable">彩灯数据库</a></li>
       <li><a href="switchtable">开关数据库</a></li>
       <li><a href="numbertable">数显表数据库</a></li>
       <li><a href="pointtable">指针表数据库</a></li>
      </ul>
     </li>
     <li><a href="#pages" aria-expanded="false" data-toggle="collapse"> <i class="fa fa-file-o"></i>模型管理 </a>
      <ul id="pages" class="collapse list-unstyled">
       <li><a href="weightSelf">我的模型</a></li>
       <li><a href="weightServlet">模型仓库</a></li>
      </ul>
     </li>
    </ul>
    <span class="heading" id="managerInfo1">管理员功能</span>
    <ul class="list-unstyled" id="managerInfo2" >
     <li><a href="manageservlet"> <i class="fa fa-globe"></i>系统管理</a></li>
     <li><a href="logmanage"> <i class="fa fa-file-o"></i>日志管理</a></li>
    </ul>
   </nav>

   <div class="content-inner form-cont"> 
    <div class="row"> 
     <div class="col-md-12">
      <!--***** BASIC FORM *****--> 
      <div class="card form" id="form1"> 
       <div class="card-header"> 
        <h3>图像拼接</h3> 
       </div> 
       <br /> 
       <form action="http://localhost:8080/upload/spellPic" enctype='multipart/form-data' method='POST'>
        <div class="row"> 
         <div class="col-md-6"> 

          <fieldset class="form-group"> 
           <legend>&nbsp 拼接方式</legend> 
           <div class="form-check"> 
            &nbsp <label class="form-check-label"> <input type="radio" class="form-check-input" name="optionsRadios" v-model="check.optionsRadios" id="optionsRadios1" value="T" checked="" /> 纵向拼接 </label>
           </div> 
           <div class="form-check"> 
            &nbsp <label class="form-check-label"> <input type="radio" class="form-check-input" name="optionsRadios" v-model="check.optionsRadios" id="optionsRadios2" value="F" checked="" /> 横向拼接 </label>
           </div> 
          </fieldset> 
          <hr/>
          <div class="form-group">
<!--           &nbsp <input type="file" name="file" class="form-control-file" id="exampleInputFile" multiple="multiple" aria-describedby="fileHelp" />-->
           <h6>&nbsp; 上传第一张图片:</h6>
           <input type="file" name="file1" class="form-control-file" id="file1"  aria-describedby="fileHelp" />
           </br>
           <h6>&nbsp; 上传第二张图片:</h6>
           <input type="file" name="file2" class="form-control-file" id="file2" aria-describedby="fileHelp" />
           <small id="fileHelp" class="form-text text-muted"></small>
          </div> 
          <hr/>
          <el-button type="primary" @click="onSubmit" plain>上传</el-button>
          <el-button type="success" @click="download" plain>下载</el-button>
          </div>
      </div> 
       </form>
      </div>
     </div>
    </div>
    <div class="demo-image__placeholder">
     <div class="block">
      <el-image :src="src">
       <div slot="placeholder" class="image-slot">
        加载中<span class="dot">...</span>
       </div>
      </el-image>
     </div>
    </div>

   </div>



  </div>
 </div>
  <!--Global Javascript -->
 <script src="../js/jquery.min.js"></script>
 <script src="../js/popper/popper.min.js"></script>
 <script src="../js/tether.min.js"></script>
 <script src="../js/bootstrap.min.js"></script>
 <script src="../js/jquery.cookie.js"></script>
 <script src="../js/jquery.validate.min.js"></script>
 <script src="../js/chart.min.js"></script>
 <script src="../js/front.js"></script>
 <script src="../js/axios-0.18.0.js" ></script>
 <script src="../js/vue.js"></script>
 <script src="../element-ui/lib/index.js"></script>
 <!--<script src="../js/chart-page.js"></script>-->
 <link rel="stylesheet" href="../element-ui/lib/theme-chalk/index.css">
  <!--Core Javascript -->
  <script>
  var ip = window.location.hostname;
  var local = window.location.host;
  var chat = new Vue({
      el:"#menuApp",
      data(){
       return {
        src:"",
        user:[],
        check: {
         optionsRadios:"T"
       },
        imgResult:[]
       }
      },
      methods: {
       onSubmit(){
          var formData = new FormData();
         //var formData = new FormData($("#form1")[0]);
          formData.append("file",$("#file1")[0].files[0]);
          formData.append("file",$("#file2")[0].files[0]);
          formData.append("optionsRadios",this.check.optionsRadios);
         axios({
          method: "post",
          url: "http://" + local + "/upload/spellPic",
          data:formData,
         }).then(resp => {
          console.log(resp.data);
          this.imgResult = resp.data;
          this.src = this.imgResult[0]["saveUrl"].replace("127.0.0.1",ip);
          console.log(this.src );
         })
       },
       download(){
        console.log(this.src);
        if(this.src === ""){
         this.$message({type: 'error', message: "无可下载的照片",customClass:'new_z_index'});
         return;
        }

        window.open("http://" + local + "/upload/downloadPic?address=" + this.src,'_blank');
       }
      },
      mounted(){
         axios({
          method:"get",
          url:"http://" + local + "/menu/hostdataservlet"
         }).then(resp =>{
          console.log(resp.data);
          this.user = resp.data;
          if(this.user.id === 15){
           $("#managerInfo1").show();
           $("#managerInfo2").show();
          }else{
           $("#managerInfo1").hide();
           $("#managerInfo2").hide();
          }
         })
      }
  })

  </script>


 </body>
</html>
